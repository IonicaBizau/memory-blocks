(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Match=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}throw TypeError('Uncaught, unspecified "error" event.')}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];handler.apply(this,args)}}else if(isObject(handler)){len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){var m;if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else{while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.listenerCount=function(emitter,type){var ret;if(!emitter._events||!emitter._events[type])ret=0;else if(isFunction(emitter._events[type]))ret=1;else ret=emitter._events[type].length;return ret};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],2:[function(require,module,exports){var process=module.exports={};var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=setTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){currentQueue[queueIndex].run()}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;clearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){setTimeout(drainQueue,0)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],3:[function(require,module,exports){var EventEmitter=require("events").EventEmitter,ShuffleArray=require("shuffle-array"),ElmSelect=require("elm-select"),Barbe=require("barbe"),IterateObject=require("iterate-object"),Ul=require("ul");function Match(elm,options,data){this.ev=new EventEmitter;this.data=options.data||data;this.found={};this.timestamps=[];this.flippedPairs=0;this.active=[];this.options=Ul.deepMerge(options,{autoremove:true,size:{x:4,y:4},classes:{active:"active"},step:{x:43,y:43}});this.blocks_count=this.options.size.x*this.options.size.y;this.count=this.blocks_count/2;if(this.blocks_count%2){throw new Error("The number of blocks should be even.")}this.ui={container:ElmSelect(elm)[0],items:[],template:options.templateElm?ElmSelect(options.templateElm)[0].outerHTML:options.template};if(!Array.isArray(this.data)){throw new Error("Data should be an array.")}}Match.prototype.check=function(elm1,elm2){var p1=elm1.getAttribute("data-pattern"),p2=elm2.getAttribute("data-pattern");if(p1===p2){elm1._found=true;elm2._found=true;this.found[p1]=[elm1,elm2];return true}return false};Match.prototype.on=function(){this.ev.on.apply(this.ev,arguments)};Match.prototype.emit=function(){this.ev.emit.apply(this.ev,arguments)};Match.prototype.shuffle=function(arr){return ShuffleArray(arr||this.data)};Match.prototype.clear=function(){this.ui.container.innerHTML=""};Match.prototype.deactivate=function(elm){this.active[this.active.indexOf(elm)]=null;if(elm._found){return this}elm.classList.remove(this.options.classes.active);this.emit("deactivate",elm)};Match.prototype.activate=function(elm){elm.classList.add(this.options.classes.active);if(!this.active[0]){this.active[0]=elm}else if(this.active[0]&&this.active[1]){this.deactivate(this.active[0]);this.deactivate(this.active[1]);this.activate(elm)}else{if(this.active[0]===elm){return this}this.active[1]=elm;this.emit("pair-flip",this.active[0],this.active[1]);if(this.check.apply(this,this.active)){this.emit("activate",elm);this.emit("success",this.active[0],this.active[1]);if(this.options.autoremove){this.active[0].remove();this.active[1].remove();this.deactivate(this.active[0]);this.deactivate(this.active[1])}if(Object.keys(this.found).length===this.count){this.win()}return this}}this.emit("activate",elm)};Match.prototype.clicked=function(elm){var self=this;elm.addEventListener("click",function(){self.activate(this)})};Match.prototype.addHandlers=function(){var self=this;ElmSelect.call(this,this.ui.container.children,this.clicked);self.on("pair-flip",function(){++self.flippedPairs})};Match.prototype.win=function(){clearInterval(this.timer);this.timestamps[1]=new Date;this.emit("win",this.timestamps[1]-this.timestamps[2])};Match.prototype.render=function(clear){var self=this,cPos={x:0,y:0,cX:0,cY:0};if(clear){self.clear()}self.shuffle();self.items=self.data.slice(0,this.blocks_count/2);IterateObject(self.items,function(cData,id){for(var newElm,frontElm,backElm,i=0;i<2;++i){newElm=document.createElement("div");newElm.setAttribute("data-pattern",id);frontElm=document.createElement("div");frontElm.classList.add("front");backElm=document.createElement("div");backElm.classList.add("back");newElm.appendChild(frontElm);newElm.appendChild(backElm);frontElm.innerHTML=Barbe(self.ui.template,cData);self.ui.items.push({element:newElm,data:cData,duplicate:!!i});self.emit("render",newElm,cData,i)}});self.shuffle(self.ui.items);self.ui.container.innerHTML=self.ui.items.map(function(c){if(cPos.cY===self.options.size.y){return""}if(cPos.cX===self.options.size.x){cPos.y+=self.options.step.y;cPos.x=0;cPos.cX=0;++cPos.cY;if(cPos.cY===self.options.size.y){return""}}c.element.style.top=cPos.y+"px";c.element.style.left=cPos.x+"px";cPos.x+=self.options.step.x;++cPos.cX;return c.element.outerHTML}).join("");self.addHandlers()};Match.prototype.start=function(){var self=this;self.render(true);self.timestamps[0]=new Date;self.timer=setInterval(function(){self.emit("time",new Date-self.timestamps[0])},1e3)};module.exports=Match},{barbe:4,"elm-select":6,events:1,"iterate-object":8,"shuffle-array":9,ul:10}],4:[function(require,module,exports){var RegexEscape=require("regex-escape");function Barbe(text,arr,data){if(!Array.isArray(arr)){data=arr;arr=["{","}"]}if(!data||data.constructor!==Object){return text}arr=arr.map(RegexEscape);var value=null,splits=[],i=0;function deep(obj,path){Object.keys(obj).forEach(function(c){value=obj[c];path.push(c);if(typeof value==="object"){return deep(value,path)}text=text.replace(new RegExp(arr[0]+path.join(".")+arr[1],"g"),value);path.pop()})}deep(data,[]);return text}module.exports=Barbe},{"regex-escape":5}],5:[function(require,module,exports){function RegexEscape(input){return input.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}RegexEscape.proto=function(){RegExp.escape=RegexEscape;return RegexEscape};module.exports=RegexEscape},{}],6:[function(require,module,exports){var Typpy=require("typpy");function ElmSelect(elm,fn,args,parent){var i=0,_args=null;if(typeof elm==="string"){if(parent){parent=ElmSelect(parent)}else{parent=document}elm=parent.querySelectorAll(elm)}if(!Typpy(elm,NodeList)&&!Typpy(elm,HTMLCollection)){elm=[elm]}if(typeof fn==="function"){if(!Array.isArray(args)){args=[args]}for(;i<elm.length;++i){_args=[elm[i]].concat(args);fn.apply(this,_args)}}return elm}module.exports=ElmSelect},{typpy:7}],7:[function(require,module,exports){function Typpy(input,target){if(arguments.length===2){return Typpy.is(input,target)}return Typpy.get(input,true)}Typpy.is=function(input,target){return Typpy.get(input,typeof target==="string")===target};Typpy.get=function(input,str){if(typeof input==="string"){return str?"string":String}if(null===input){return str?"null":null}if(undefined===input){return str?"undefined":undefined}if(input!==input){return str?"nan":NaN}return str?input.constructor.name.toLowerCase():input.constructor};module.exports=Typpy},{}],8:[function(require,module,exports){function IterateObject(obj,fn){var i=0,keys=[];if(Array.isArray(obj)){for(;i<obj.length;++i){if(fn(obj[i],i,obj)===false){break}}}else{keys=Object.keys(obj);for(;i<keys.length;++i){if(fn(obj[keys[i]],keys[i],obj)===false){break}}}}module.exports=IterateObject},{}],9:[function(require,module,exports){"use strict";function shuffle(arr,options){if(!Array.isArray(arr)){throw new Error("shuffle expect an array as parameter.")}options=options||{};var collection=arr,len=arr.length,rng=options.rng||Math.random,random,temp;if(options.copy===true){collection=arr.slice()}while(len){random=Math.floor(rng()*len);len-=1;temp=collection[len];collection[len]=collection[random];collection[random]=temp}return collection}shuffle.pick=function(arr,options){if(!Array.isArray(arr)){throw new Error("shuffle.pick() expect an array as parameter.")}options=options||{};var rng=options.rng||Math.random,picks=options.picks||1;if(typeof picks==="number"&&picks!==1){var len=arr.length,collection=arr.slice(),random=[],index;while(picks){index=Math.floor(rng()*len);random.push(collection[index]);collection.splice(index,1);len-=1;picks-=1}return random}return arr[Math.floor(rng()*arr.length)]};module.exports=shuffle},{}],10:[function(require,module,exports){(function(process){var Typpy=require("typpy"),Deffy=require("deffy");function Ul(){}Ul.prototype.merge=function(dst,src,p){var res={},k=null;src=Deffy(src,{});dst=Deffy(dst,{});for(k in src){res[k]=src[k]}for(k in dst){if(undefined===dst[k]){continue}res[k]=dst[k]}return res};Ul.prototype.deepMerge=function(){var dst={},src,p,args=[].splice.call(arguments,0);while(args.length>0){src=args.splice(-1)[0];if(Typpy(src)!=="object"){continue}for(p in src){if(!src.hasOwnProperty(p)){continue}if(Typpy(src[p])==="object"){dst[p]=this.deepMerge(src[p],dst[p]||{})}else{if(src[p]!==undefined){dst[p]=src[p]}}}}return dst};Ul.prototype.clone=function(item){if(!item){return item}var self=this,types=[Number,String,Boolean],result,i;types.forEach(function(type){if(item instanceof type){result=type(item)}});if(typeof result=="undefined"){if(Array.isArray(item)){result=[];item.forEach(function(child,index){result[index]=self.clone(child)})}else if(typeof item=="object"){if(!item.prototype){if(item instanceof Date){result=new Date(item)}else{result={};for(i in item){result[i]=self.clone(item[i])}}}else{result=item}}else{result=item}}return result};Ul.prototype.HOME_DIR=process.env[process.platform=="win32"?"USERPROFILE":"HOME"];Ul.prototype.home=function(){return this.HOME_DIR};module.exports=new Ul}).call(this,require("_process"))},{_process:2,deffy:11,typpy:12}],11:[function(require,module,exports){var Typpy=require("typpy");function Deffy(input,def,options){if(typeof def==="function"){return def(input)}options=Typpy(options)==="boolean"?{empty:options}:{empty:false};if(options.empty){return input||def}if(Typpy(input)===Typpy(def)){return input}return def}module.exports=Deffy},{typpy:12}],12:[function(require,module,exports){function Typpy(input){if(typeof input==="string"){return"string"}if(null===input){return"null"}if(undefined===input){return"undefined"}return input.constructor.name.toLowerCase()}module.exports=Typpy},{}]},{},[3])(3)});